import{a as m,j as e,z as y,q as D,g as F,s as A,r as z,h as E}from"./index-BEf5F9yr.js";import{r as n}from"./vendor-C-9pyWRM.js";import{A as P}from"./AdminLayout-BB7XbEv1.js";import"./icons-4heOFlV7.js";import"./swiper-CLjMzi4o.js";function M(){var h,p,g;const[x,b]=n.useState([]),[t,f]=n.useState({}),[j,u]=n.useState(!0),[N,c]=n.useState(!1),[a,o]=n.useState(null),[r,i]=n.useState({body:"",answer:"",status:"draft",show_on_homepage:!1});n.useEffect(()=>{d()},[]);const d=async(s=1)=>{try{u(!0);const l=await m.getAdminComments();b(l.data||[]),f(l)}catch(l){console.error("Failed to load comments:",l),alert("Failed to load comments")}finally{u(!1)}},v=s=>{o(s),i({body:s.body,answer:s.answer||"",status:s.status,show_on_homepage:s.show_on_homepage||!1}),c(!0)},w=async s=>{s.preventDefault();try{await m.updateComment(a.id,r),c(!1),o(null),d()}catch(l){console.error("Failed to update comment:",l),alert("Failed to update comment")}},_=async(s,l)=>{if(confirm(`Are you sure you want to delete comment by ${l}?`))try{await m.deleteComment(s),d()}catch(k){console.error("Failed to delete comment:",k),alert("Failed to delete comment")}},C=x.filter(s=>s.status==="draft").length,S=x.filter(s=>s.status==="published").length;return e.jsx(P,{children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-10",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Comment Moderation"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Review, edit, and answer customer questions"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Draft (Hidden)"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:C})]}),e.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:e.jsx(y,{className:"text-yellow-600",size:24})})]})}),e.jsx("div",{className:"bg-white rounded-xl border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Published (Visible)"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:S})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx(y,{className:"text-green-600",size:24})})]})})]}),j?e.jsx("div",{className:"text-center py-20 text-gray-400",children:"Loading..."}):e.jsxs("div",{className:"bg-white rounded-xl border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Question"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Answer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Homepage"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-8 text-center text-gray-400",children:"No comments found."})}):x.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsxs("div",{className:"font-medium text-gray-900",children:[s.user.first_name," ",s.user.last_name]})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("div",{className:"max-w-xs",children:s.product?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.product.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",s.product.id]})]}):e.jsx("span",{className:"text-gray-500 italic text-xs",children:"General Question"})})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:e.jsx("div",{className:"max-w-md",children:s.body.length>100?`${s.body.substring(0,100)}...`:s.body})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:e.jsx("div",{className:"max-w-md",children:s.answer?s.answer.length>80?`${s.answer.substring(0,80)}...`:s.answer:e.jsx("span",{className:"text-gray-400 italic",children:"No answer"})})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status==="published"?"Published":"Draft"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:s.show_on_homepage?e.jsxs("div",{className:"inline-flex items-center gap-1 text-brand-600",children:[e.jsx(D,{size:18}),e.jsx(F,{size:14})]}):e.jsx(A,{className:"text-gray-300 mx-auto",size:18})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right text-sm",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs("button",{onClick:()=>v(s),className:"inline-flex items-center gap-1 px-3 py-1 text-xs font-medium text-blue-700 bg-blue-50 rounded hover:bg-blue-100 transition-colors",title:"Edit",children:[e.jsx(z,{size:14}),"Edit"]}),e.jsxs("button",{onClick:()=>_(s.id,`${s.user.first_name} ${s.user.last_name}`),className:"inline-flex items-center gap-1 px-3 py-1 text-xs font-medium text-red-700 bg-red-50 rounded hover:bg-red-100 transition-colors",title:"Delete",children:[e.jsx(E,{size:14}),"Delete"]})]})})]},s.id))})]})}),(t==null?void 0:t.last_page)>1&&e.jsxs("div",{className:"px-6 py-4 border-t flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",t.from," to ",t.to," of ",t.total," comments"]}),e.jsxs("div",{className:"flex gap-2",children:[t.current_page>1&&e.jsx("button",{onClick:()=>d(t.current_page-1),className:"px-3 py-1 text-sm border rounded hover:bg-gray-50",children:"Previous"}),t.current_page<t.last_page&&e.jsx("button",{onClick:()=>d(t.current_page+1),className:"px-3 py-1 text-sm border rounded hover:bg-gray-50",children:"Next"})]})]})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Edit Comment"}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Product:"})," ",((h=a==null?void 0:a.product)==null?void 0:h.title)||e.jsx("span",{className:"italic text-gray-500",children:"General Question"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Asked by:"})," ",(p=a==null?void 0:a.user)==null?void 0:p.first_name," ",(g=a==null?void 0:a.user)==null?void 0:g.last_name]})]})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Question"}),e.jsx("textarea",{value:r.body,onChange:s=>i({...r,body:s.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,maxLength:2e3}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You can edit the question to improve clarity or fix typos"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Answer"}),e.jsx("textarea",{value:r.answer,onChange:s=>i({...r,answer:s.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add your answer here...",maxLength:2e3}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'This will be displayed publicly as "Official Answer"'})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:r.status,onChange:s=>i({...r,status:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"draft",children:"Draft (Hidden from customers)"}),e.jsx("option",{value:"published",children:"Published (Visible on product page)"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.show_on_homepage,onChange:s=>i({...r,show_on_homepage:s.target.checked}),className:"w-4 h-4 text-brand-600 border-gray-300 rounded focus:ring-brand-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show on Homepage"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Display this Q&A in the featured questions section on the homepage"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{c(!1),o(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Save Changes"})]})]})]})})]})})}export{M as default};
