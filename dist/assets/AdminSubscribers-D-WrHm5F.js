import{a as o,j as e,i as h,d as m}from"./index-QL_l2HKz.js";import{r as l}from"./vendor-CYrxFWZT.js";import{A as g}from"./AdminLayout-BTkHXMkf.js";import"./icons-CVqXpeR9.js";import"./swiper-CLjMzi4o.js";function w(){const[s,p]=l.useState(null),[b,i]=l.useState(!0);l.useEffect(()=>{c()},[]);const c=async(t=1)=>{try{i(!0);const r=await o.getAdminSubscribers();p(r)}catch(r){console.error("Failed to load subscribers:",r),alert("Failed to load subscribers")}finally{i(!1)}},u=async()=>{try{const r=await(await o.exportSubscribers()).blob(),x=window.URL.createObjectURL(r),a=document.createElement("a");a.href=x,a.setAttribute("download",`subscribers-${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(x)}catch(t){console.error("Export failed:",t),alert("Failed to export subscribers")}},n=(s==null?void 0:s.stats)||{total_active:0,total_unsubscribed:0},d=(s==null?void 0:s.data)||[];return e.jsx(g,{children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Subscribers"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Newsletter subscription management"})]}),e.jsxs("button",{onClick:u,className:"flex items-center gap-2 bg-brand-600 text-white px-4 py-2 rounded-lg hover:bg-brand-700 transition-colors",children:[e.jsx(h,{size:18}),"Export CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Active Subscribers"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:n.total_active})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx(m,{className:"text-green-600",size:24})})]})}),e.jsx("div",{className:"bg-white rounded-xl border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Unsubscribed"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:n.total_unsubscribed})]}),e.jsx("div",{className:"bg-gray-100 p-3 rounded-lg",children:e.jsx(m,{className:"text-gray-600",size:24})})]})})]}),b?e.jsx("div",{className:"text-center py-20 text-gray-400",children:"Loading..."}):e.jsxs("div",{className:"bg-white rounded-xl border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Source"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subscribed At"})]})}),e.jsx("tbody",{className:"divide-y",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-8 text-center text-gray-400",children:"No subscribers found."})}):d.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:t.email}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:t.first_name?`${t.first_name} ${t.last_name||""}`.trim():"â€”"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:t.source||"Direct"}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.unsubscribed_at?"bg-gray-100 text-gray-800":"bg-green-100 text-green-800"}`,children:t.unsubscribed_at?"Unsubscribed":"Active"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(t.subscribed_at).toLocaleDateString()})]},t.id))})]})}),(s==null?void 0:s.last_page)>1&&e.jsxs("div",{className:"px-6 py-4 border-t flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",s.from," to ",s.to," of ",s.total," subscribers"]}),e.jsxs("div",{className:"flex gap-2",children:[s.current_page>1&&e.jsx("button",{onClick:()=>c(s.current_page-1),className:"px-3 py-1 text-sm border rounded hover:bg-gray-50",children:"Previous"}),s.current_page<s.last_page&&e.jsx("button",{onClick:()=>c(s.current_page+1),className:"px-3 py-1 text-sm border rounded hover:bg-gray-50",children:"Next"})]})]})]})]})})}export{w as default};
