import{u,a as i,j as s,f as p,i as f}from"./index-QL_l2HKz.js";import{r as d,L as x}from"./vendor-CYrxFWZT.js";import"./icons-CVqXpeR9.js";import"./swiper-CLjMzi4o.js";function N(){var l,n;const{user:o}=u(),[a,m]=d.useState(null);d.useEffect(()=>{i.getDashboard().then(e=>{var t,r,c;console.log("Dashboard data:",e),console.log("Orders:",e==null?void 0:e.orders),console.log("Orders data:",(t=e==null?void 0:e.orders)==null?void 0:t.data),console.log("First order full:",JSON.stringify((c=(r=e==null?void 0:e.orders)==null?void 0:r.data)==null?void 0:c[0],null,2)),m(e)}).catch(e=>{console.error("Dashboard error:",e)})},[]);const h=async e=>{try{await i.downloadProduct(e)}catch(t){console.error("Download failed:",t),alert("Download failed. Please try again.")}};return s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-10",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-1",children:"Dashboard"}),s.jsxs("p",{className:"text-gray-500 mb-8",children:["Welcome back, ",o==null?void 0:o.first_name,"!"]}),s.jsxs("div",{className:"bg-white rounded-xl border",children:[s.jsx("div",{className:"p-6 border-b flex items-center justify-between",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(p,{})," My Purchases"]})}),((n=(l=a==null?void 0:a.orders)==null?void 0:l.data)==null?void 0:n.length)>0?s.jsx("div",{className:"divide-y",children:a.orders.data.map(e=>{var t;return s.jsxs("div",{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-xs text-gray-400",children:["Order #",e.id," â€” ",new Date(e.paid_at).toLocaleDateString()]}),s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",parseFloat(e.total).toFixed(2)]})]}),(t=e.items)==null?void 0:t.map(r=>s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsx(x,{to:`/products/${r.product.slug}`,className:"text-gray-700 hover:text-brand-600 font-medium text-sm",children:r.product.title}),s.jsxs("button",{onClick:()=>h(r.product.id),className:"flex items-center gap-1 text-brand-600 hover:text-brand-700 text-sm font-medium",children:[s.jsx(f,{size:14})," Download"]})]},r.id))]},e.id)})}):s.jsxs("div",{className:"p-12 text-center",children:[s.jsx("p",{className:"text-gray-400 mb-4",children:"You haven't purchased anything yet."}),s.jsx(x,{to:"/products",className:"text-brand-600 hover:text-brand-700 font-medium",children:"Browse products"})]})]})]})}export{N as default};
