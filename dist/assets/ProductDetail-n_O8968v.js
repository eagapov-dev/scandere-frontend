import{u as _,e as D,j as e,h as P,i as Q,g as L,k as x,a as m}from"./index-QL_l2HKz.js";import{d as R,r as d,L as l}from"./vendor-CYrxFWZT.js";import{P as U}from"./ProductCard-8_ZdCywd.js";import"./icons-CVqXpeR9.js";import"./swiper-CLjMzi4o.js";function z(){const{slug:g}=R(),{user:i}=_(),{addToCart:N}=D(),[r,w]=d.useState(null),[v,b]=d.useState(!0),[o,u]=d.useState(""),[h,p]=d.useState(!1),f=()=>m.getProduct(g).then(w).catch(()=>{}).finally(()=>b(!1));d.useEffect(()=>{b(!0),f()},[g]);const k=async()=>{if(!i){window.location.href="/login";return}try{await N(r.product.id)}catch(t){alert(t.message||"Failed.")}},C=async()=>{try{const j=await(await m.downloadProduct(r.product.id)).blob(),y=window.URL.createObjectURL(j),c=document.createElement("a");c.href=y,c.download=r.product.file_name||"file",c.click(),window.URL.revokeObjectURL(y)}catch{alert("Download failed.")}},A=async t=>{if(t.preventDefault(),!!o.trim()){p(!0);try{await m.postComment(r.product.id,o),u(""),f()}catch{alert("Failed to post comment.")}p(!1)}};if(v)return e.jsx("div",{className:"text-center py-20 text-gray-400",children:"Loading..."});if(!r)return e.jsx("div",{className:"text-center py-20 text-gray-400",children:"Product not found."});const{product:s,has_purchased:S,comments:a,related:n}=r,F={pdf:"bg-red-100 text-red-700",xlsx:"bg-green-100 text-green-700",docx:"bg-blue-100 text-blue-700"};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-10",children:[e.jsx(l,{to:"/products",className:"text-brand-600 hover:text-brand-700 text-sm mb-6 inline-block",children:"← Back to products"}),e.jsx("div",{className:"bg-white rounded-xl border p-6 md:p-8 mb-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("div",{className:"md:w-2/5",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-12 flex flex-col items-center justify-center aspect-[4/3]",children:[e.jsx(P,{size:64,className:"text-gray-300 mb-4"}),s.file_type&&e.jsxs("span",{className:`text-sm font-bold px-3 py-1 rounded ${F[s.file_type]||"bg-gray-100 text-gray-700"}`,children:[s.file_type.toUpperCase()," Document"]})]})}),e.jsxs("div",{className:"md:w-3/5",children:[s.category&&e.jsx("span",{className:"text-sm font-medium text-brand-600 uppercase tracking-wide",children:s.category.name}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mt-1 mb-3",children:s.title}),e.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:[s.download_count," downloads"]}),e.jsx("div",{className:`text-3xl font-bold mb-6 ${s.is_free?"text-green-600":"text-gray-900"}`,children:s.is_free?"Free":`$${parseFloat(s.price).toFixed(2)}`}),s.description&&e.jsx("div",{className:"text-gray-600 mb-8 whitespace-pre-line leading-relaxed",children:s.description}),i?S||s.is_free?e.jsxs("button",{onClick:C,className:"flex items-center gap-2 bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700 font-medium text-lg",children:[e.jsx(Q,{})," Download Now"]}):e.jsxs("button",{onClick:k,className:"flex items-center gap-2 bg-brand-600 text-white px-8 py-3 rounded-lg hover:bg-brand-700 font-medium text-lg",children:[e.jsx(L,{})," Add to Cart — $",parseFloat(s.price).toFixed(2)]}):e.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[e.jsx("p",{className:"text-gray-700 mb-3",children:"Sign in to purchase and download this product."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{to:"/login",className:"bg-brand-600 text-white px-6 py-2 rounded-lg hover:bg-brand-700 font-medium",children:"Sign In"}),e.jsx(l,{to:"/register",className:"bg-white text-brand-600 border border-brand-600 px-6 py-2 rounded-lg hover:bg-brand-50 font-medium",children:"Sign Up"})]})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl border p-6 md:p-8 mb-10",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(x,{})," Questions & Answers (FAQ)"]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Real questions from customers like you. Have a question? Ask below and get answers from our community!"}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-xs font-semibold mt-2",children:[(a==null?void 0:a.length)||0," ",(a==null?void 0:a.length)===1?"Question":"Questions"," Asked"]})]}),i?e.jsxs("div",{className:"bg-gradient-to-br from-brand-50 to-brand-100 rounded-xl p-6 mb-8 border-2 border-brand-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(x,{className:"text-brand-600"}),"Ask a Question"]}),e.jsxs("form",{onSubmit:A,children:[e.jsx("textarea",{value:o,onChange:t=>u(t.target.value),rows:3,required:!0,placeholder:"What would you like to know about this product? Other customers or our team will help answer...",className:"w-full px-4 py-3 border border-brand-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 resize-none mb-3 bg-white"}),e.jsx("button",{type:"submit",disabled:h,className:"bg-brand-600 text-white px-6 py-3 rounded-lg hover:bg-brand-700 font-semibold text-sm disabled:opacity-50 shadow-lg hover:shadow-xl transition-all",children:h?"Posting Question...":"Post Question"})]})]}):e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-8 border-2 border-gray-200 text-center",children:[e.jsx("p",{className:"text-gray-700 mb-3",children:"Have a question about this product?"}),e.jsx(l,{to:"/login",className:"inline-flex items-center gap-2 bg-brand-600 text-white px-6 py-3 rounded-lg hover:bg-brand-700 font-semibold transition-all",children:"Sign In to Ask a Question"})]}),(a==null?void 0:a.length)>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg mb-4",children:"Customer Questions & Answers"}),a.map((t,j)=>e.jsxs("div",{className:"bg-gray-50 rounded-xl p-5 border-l-4 border-brand-500 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-brand-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"Q"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-semibold text-gray-900",children:[t.user.first_name," ",t.user.last_name]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["asked on ",new Date(t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),e.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.body})]})]})}),t.answer?e.jsxs("div",{className:"flex items-start gap-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"A"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Scandere AI Team"}),e.jsx("span",{className:"text-xs px-2 py-0.5 bg-brand-100 text-brand-700 rounded-full",children:"Official Answer"})]}),e.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.answer})]})]}):e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsx("p",{className:"text-gray-400 text-sm italic",children:"Awaiting answer from our team..."})})]},t.id))]}):e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300",children:[e.jsx(x,{size:48,className:"text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 font-medium mb-2",children:"No questions yet"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Be the first to ask a question about this product!"})]})]}),(n==null?void 0:n.length)>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Related Products"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:n.map(t=>e.jsx(U,{product:t,compact:!0},t.id))})]})]})}export{z as default};
